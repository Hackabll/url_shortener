const axios = require("axios");

async function checkUrl(url){
    const endpoint = `https://safebrowsing.googleapis.com/v4/threatMatches:find?key=${process.env.SAFE_BROWSING_KEY}`;
    const body = {
        client : {
            clientId: "url-shortener",
            clientVersion: "1.0"
        },
        threatInfo: {
            threatTypes: ["MALWARE", "SOCIAL_ENGINEERING"],
            platformTypes: ["ANY_PLATFORM"],
            threatEntryTypes: ["URL"],
            threatEntries: [
            { url: url }
            ]
        }

    };

    const res = await axios.post(endpoint,body);

    return res.data.matches;   
}

module.exports = checkUrl;